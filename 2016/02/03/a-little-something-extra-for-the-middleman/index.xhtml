<?xml version="1.0" encoding="utf-8"?> <?xml-stylesheet href="../../../../stylesheets/visual-d371f903.css" media="print,screen"?> <?xml-stylesheet href="../../../../stylesheets/print-42792b28.css" media="print"?> <?xml-stylesheet href="../../../../stylesheets/screen-f18161d2.css" media="screen"?> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-gb-oxendict"> <head> <meta name="viewport" content="width=device-width, initial-scale=1"/> <title>A&#160;little something eXtra for the&#160;Middleman—Fear Goidte</title> <link rel="canonical" href="https://isfeargoidte.me.uk/2016/02/03/a-little-something-extra-for-the-middleman"/> <link property="rdfa:copy" href="#ccpattern"/> <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml"/> <link rel="apple-touch-icon" sizes="57x57" href="../../../../images/icons/favicons/apple-touch-icon-57x57-2a3cc969.png"/> <link rel="apple-touch-icon" sizes="60x60" href="../../../../images/icons/favicons/apple-touch-icon-60x60-1af4e7c4.png"/> <link rel="apple-touch-icon" sizes="72x72" href="../../../../images/icons/favicons/apple-touch-icon-72x72-83fb944a.png"/> <link rel="apple-touch-icon" sizes="76x76" href="../../../../images/icons/favicons/apple-touch-icon-76x76-ba38ff8e.png"/> <link rel="apple-touch-icon" sizes="114x114" href="../../../../images/icons/favicons/apple-touch-icon-114x114-8c7461bb.png"/> <link rel="apple-touch-icon" sizes="120x120" href="../../../../images/icons/favicons/apple-touch-icon-120x120-61eda8dc.png"/> <link rel="apple-touch-icon" sizes="144x144" href="../../../../images/icons/favicons/apple-touch-icon-144x144-dbae851f.png"/> <link rel="apple-touch-icon" sizes="152x152" href="../../../../images/icons/favicons/apple-touch-icon-152x152-7cff5c09.png"/> <link rel="apple-touch-icon" sizes="180x180" href="../../../../images/icons/favicons/apple-touch-icon-180x180-a952c0b9.png"/> <link rel="icon" type="image/png" href="../../../../images/icons/favicons/favicon-32x32-db637568.png" sizes="32x32"/> <link rel="icon" type="image/png" href="../../../../images/icons/favicons/favicon-194x194-a63210d5.png" sizes="194x194"/> <link rel="icon" type="image/png" href="../../../../images/icons/favicons/favicon-96x96-5b0b9c2b.png" sizes="96x96"/> <link rel="icon" type="image/png" href="../../../../images/icons/favicons/android-chrome-192x192-e83a636a.png" sizes="192x192"/> <link rel="icon" type="image/png" href="../../../../images/icons/favicons/favicon-16x16-ed280661.png" sizes="16x16"/> <link rel="manifest" href="/images/icons/favicons/manifest.json"/> <link rel="mask-icon" href="../../../../images/icons/favicons/safari-pinned-tab-2bcc2848.svg"/> <link rel="shortcut icon" href="../../../../images/icons/favicons/favicon-f27fff1c.ico"/> <meta name="msapplication-TileColor" content="#da532c"/> <meta name="msapplication-TileImage" content="../../../../images/icons/favicons/mstile-144x144-b8ec8551.png"/> <meta name="msapplication-config" content="/images/icons/favicons/browserconfig.xml"/> <meta name="theme-color" content="#ffffff"/> <meta name="author" content="James Ó Nuanáin"/> <meta property="author" content="James Ó Nuanáin"/> <meta property="og:type" content="article"/> <meta property="og:locale" content="en_GB"/> <meta property="og:title" content="A&#160;little something eXtra for the&#160;Middleman—Fear Goidte"/> <meta property="og:description" content="A short inexhaustive guide to adapting Middleman 4.0.0 to output X.H.T.M.L. rather than H.T.M.L. "/> <meta property="og:article:tag" content="Middleman, application/xhtml+xml, Markdown, Redcarpet, XHTML, Ruby"/> <meta property="og:article:published_time" content="2016-02-03"/> <meta property="og:url" content="https://isfeargoidte.me.uk/2016/02/03/a-little-something-extra-for-the-middleman"/> <meta property="og:image" content="../../../../images/2016-02-03-a-little-something-extra-for-the-middleman-a2a402a4.svg"/> <meta property="og:image:secure_url" content="../../../../images/2016-02-03-a-little-something-extra-for-the-middleman-a2a402a4.svg"/> <meta property="og:image:type" content="image/svg"/> <meta name="twitter:card" content="summary"/> <meta name="twitter:site" content="@feargoidte"/> <meta name="twitter:title" content="A&#160;little something eXtra for the&#160;Middleman—Fear Goidte"/> <meta name="twitter:description" content="A short inexhaustive guide to adapting Middleman 4.0.0 to output X.H.T.M.L. rather than H.T.M.L. "/> <meta name="twitter:image" content="../../../../images/2016-02-03-a-little-something-extra-for-the-middleman-a2a402a4.svg"/> <meta name="description" content="A short inexhaustive guide to adapting Middleman 4.0.0 to output X.H.T.M.L. rather than H.T.M.L. "/> </head> <body> <a href="#nav_main">Skip to main content</a> <div role="banner"> <dl> <dt xml:lang="ga-ie"><a href="../../../../">Fear Goidte</a></dt> <dd>Pronounced like “Far Gotcha”. The splendid online isolation of me, James Ó Nuanáin, wherein I gather together any loose cleverness that I manage to accumulate. This site is, primarily an exegesis on how it was made. For the moment, it is mostly beak and bone with very little feather and fur. </dd> </dl> <div role="navigation"> <ol> <li><a href="../../../../" accesskey="1">Home</a></li> <li><a href="../../../../archives">Archives</a></li> <li><a href="#nav_copyright" accesskey="6">Copyright</a></li> <li><a href="#nav_accesskeys" accesskey="k">Access keys</a></li> <li><a href="/atom.xml" rel="alternate" accesskey="f">Web feed</a></li> <li><a href="../../../../colophon">Colophon</a></li> </ol> </div> </div> <main id="nav_main" typeof="DCMIType:text schema:Article" resource="https://isfeargoidte.me.uk/2016/02/03/a-little-something-extra-for-the-middleman"> <header> <p class="published-date icon"><time property="dcterms:created schema:dateCreated schema:datePublished" datetime="2016-02-03">Wednesday 3<sup>rd</sup>&#160;February,&#160;2016</time></p> <h1 property="dcterms:title schema:Headline">A&#160;little something eXtra for the&#160;Middleman</h1> <p class="author icon">James Ó Nuanáin</p> <p class="reading-time icon">Estimated reading time: four minutes</p> <dl> <dt>Tagged with</dt> <dd><a href="/tags/application-xhtml-xml" rel="tag"><code>application/xhtml+xml</code></a></dd> <dd><a href="/tags/markdown" rel="tag">Markdown</a></dd> <dd><a href="/tags/middleman" rel="tag">Middleman</a></dd> <dd><a href="/tags/redcarpet" rel="tag">Redcarpet</a></dd> <dd><a href="/tags/ruby" rel="tag">Ruby</a></dd> <dd><a href="/tags/xhtml" rel="tag"><abbr title="eXtensible Hypertext Mark-up Language" class="initialism">X.H.T.M.L.</abbr></a></dd> </dl> <link property="rdfa:copy" href="#ccpattern"/> </header> <nav><h2>Table of contents</h2><ol property="dcterms:tableofContents"> <li> <a href="#markdown">Markdown</a> </li> <li> <a href="#directory-indices">Directory indices</a> </li> <li> <a href="#blog-settings">Blog settings</a> </li> <li> <a href="#source-file-extensions">Source file extensions</a> </li> <li> <a href="#the-layout-file">The layout file</a> </li> <li> <a href="#envoi">Envoi</a> </li> </ol> </nav> <object data="../../../../images/2016-02-03-a-little-something-extra-for-the-middleman-a2a402a4.svg"></object> <p property="dcterms:description schema:description">A short inexhaustive guide to adapting <a href="https://middlemanapp.com">Middleman 4.0.0</a> to output <abbr title="eXtensible Hypertext Mark-up Language" class="initialism">X.H.T.M.L.</abbr> rather than <abbr title="Hypertext Mark-up Language" class="initialism">H.T.M.L.</abbr> </p> <p><em>Whilst the following article might still have some use for converting an existing site, I have put together an <a href="https://github.com/FearGoidte/middleman-templates-blog-xhtml"><abbr title="eXtensible Hypertext Mark-up Language" class="initialism">X.H.T.M.L.</abbr> Middleman template</a> which, in one fell swoop, sets up up everything</em>.</p> <p>I’m not going to prattle on about which mark-up version is better. Suffice to say, I made the switch a long time ago and prefer to use <abbr title="eXtensible Hypertext Mark-up Language" class="initialism">X.H.T.M.L.</abbr></p> <p>This is based on a vanilla setup of Middleman <em>4.0.0</em> and middleman-blog with the <a href="https://middlemanapp.com/basics/blogging/">blog template used to initiate the Middleman skeleton project</a>. <code>my_test_website</code> is used to refer to the directory which contains the Middleman skeleton project files.</p> <h2 id="markdown">Markdown</h2> <p>Since <abbr title="eXtensible Hypertext Mark-up Language" class="initialism">X.H.T.M.L.</abbr> has strict syntax you’ll want to switch your Markdown render to its <abbr title="eXtensible Hypertext Mark-up Language" class="initialism">X.H.T.M.L.</abbr> version. In the case of <a href="https://github.com/vmg/redcarpet">Redcarpet</a> (the default in Middleman 4.0.0), by adding the following to <code>my_test_website\config.rb</code>:</p> <pre class="code-quote ruby"><code><span class="c1"># Markdown settings</span>
<span class="n">set</span> <span class="ss">:markdown_engine</span><span class="p">,</span> <span class="ss">:redcarpet</span>
<span class="n">set</span> <span class="ss">:markdown</span><span class="p">,</span> <span class="ss">xhtml: </span><span class="kp">true</span>
</code></pre> <h2 id="directory-indices">Directory indices</h2> <p>It’s always a good idea to use ‘pretty’ <abbr title="uniform resource locator" class="initialism">U.R.L.</abbr>s which exclude file extensions since they leave us open to changing language in the future and <a href="http://www.w3.org/Provider/Style/URI.html">Cool <abbr title="uniform resource identifier">U.R.I.</abbr>s don’t change</a>.</p> <p>Directory indices in Middleman default to <code>index.html</code> so in <code>my_test_website\config.rb</code> underneath:</p> <pre class="code-quote ruby"><code><span class="c1"># Activate directory indices and remove file extensions from urls</span>
<span class="n">activate</span> <span class="ss">:directory_indexes</span>
</code></pre> <p>Add the line:</p> <pre class="code-quote ruby"><code><span class="n">set</span> <span class="ss">:index_file</span><span class="p">,</span> <span class="s1">'index.xhtml'</span>
</code></pre> <h2 id="blog-settings">Blog settings</h2> <p>The blog helper defaults to specifying <code>.html</code> files, so in <code>my_test_website\config.rb</code> you need to change the following settings:</p> <pre class="code-quote ruby"><code>  <span class="c1"># blog.permalink = "{year}/{month}/{day}/{title}.html"</span>
  <span class="c1"># blog.sources = "{year}-{month}-{day}-{title}.html"</span>
  <span class="c1"># blog.taglink = "tags/{tag}.html"</span>
  <span class="c1"># blog.year_link = "{year}.html"</span>
  <span class="c1"># blog.month_link = "{year}/{month}.html"</span>
  <span class="c1"># blog.day_link = "{year}/{month}/{day}.html"</span>
  <span class="n">blog</span><span class="p">.</span><span class="nf">tag_template</span> <span class="o">=</span> <span class="s2">"tag.html"</span>
  <span class="n">blog</span><span class="p">.</span><span class="nf">calendar_template</span> <span class="o">=</span> <span class="s2">"calendar.html"</span>
</code></pre> <p>To (a simple find and replace from <code>.html</code> to <code>.xhtml</code>):</p> <pre class="code-quote ruby"><code>  <span class="n">blog</span><span class="p">.</span><span class="nf">permalink</span> <span class="o">=</span> <span class="s1">'{year}/{month}/{day}/{title}.xhtml'</span>
  <span class="n">blog</span><span class="p">.</span><span class="nf">sources</span> <span class="o">=</span> <span class="s1">'{year}-{month}-{day}-{title}.xhtml'</span>
  <span class="n">blog</span><span class="p">.</span><span class="nf">taglink</span> <span class="o">=</span> <span class="s1">'tags/{tag}.xhtml'</span>
  <span class="n">blog</span><span class="p">.</span><span class="nf">year_link</span> <span class="o">=</span> <span class="s1">'{year}.xhtml'</span>
  <span class="n">blog</span><span class="p">.</span><span class="nf">month_link</span> <span class="o">=</span> <span class="s1">'{year}/{month}.xhtml'</span>
  <span class="n">blog</span><span class="p">.</span><span class="nf">day_link</span> <span class="o">=</span> <span class="s1">'{year}/{month}/{day}.xhtml'</span>
  <span class="n">blog</span><span class="p">.</span><span class="nf">tag_template</span> <span class="o">=</span> <span class="s1">'tag.xhtml'</span>
  <span class="n">blog</span><span class="p">.</span><span class="nf">calendar_template</span> <span class="o">=</span> <span class="s1">'calendar.xhtml'</span>
</code></pre> <p>The important thing is to uncomment all the lines that now contain <code>.xhtml</code>.</p> <h2 id="source-file-extensions">Source file extensions</h2> <p>In the directory <code>my_test_website\source</code> files, you need to change:</p> <ul> <li><code>calendar.html.erb</code> to <code>calendar.xhtml.erb</code></li> <li><code>index.html.erb</code> to <code>index.xhtml.erb</code></li> <li><code>tag.html.erb</code> to <code>tag.xhtml.erb</code></li> </ul> <p>As well as any other none-article\blog <code>.xhtml</code> files you want to add to source.</p> <p>For any existing articles/post you need to change the extensions from <code>html.markdown</code> to <code>xhtml.markdown</code>.</p> <p>Since Middleman 4.0.0.rc.2:</p> <blockquote> <footer><cite><a href="https://github.com/middleman/middleman/blob/master/CHANGELOG.md#400rc2">Middleman change log</a></cite></footer> Rather than applying layouts to all files which are not <code>.txt</code>, <code>.css</code>, <code>.js</code>, <code>.json</code>: the new behavior is to only default layouts to active for <code>.html</code> </blockquote> <p>This means that in <code>my_test_website\config.rb</code> you need to replace:</p> <pre class="code-quote ruby"><code><span class="c1"># Per-page layout changes:</span>
<span class="c1">#</span>
<span class="c1"># With no layout</span>
<span class="n">page</span> <span class="s1">'/*.xml'</span><span class="p">,</span> <span class="ss">layout: </span><span class="kp">false</span>
<span class="n">page</span> <span class="s1">'/*.json'</span><span class="p">,</span> <span class="ss">layout: </span><span class="kp">false</span>
<span class="n">page</span> <span class="s1">'/*.txt'</span><span class="p">,</span> <span class="ss">layout: </span><span class="kp">false</span>

<span class="c1"># With alternative layout</span>
<span class="c1"># page "/path/to/file.html", layout: :otherlayout</span>

<span class="c1"># Proxy pages (http://middlemanapp.com/basics/dynamic-pages/)</span>
<span class="c1"># proxy "/this-page-has-no-template.html", "/template-file.html", locals: {</span>
<span class="c1">#  which_fake_page: "Rendering a fake page with a local variable" }</span>
</code></pre> <p>with:</p> <pre class="code-quote ruby"><code><span class="c1"># Per-page layout changes:</span>
<span class="n">page</span> <span class="s1">'/*.xhtml'</span><span class="p">,</span> <span class="ss">layout: </span><span class="s1">'layout'</span>
<span class="n">page</span> <span class="s1">'/articles/*.xhtml'</span><span class="p">,</span> <span class="ss">layout: </span><span class="s1">'article'</span>
</code></pre> <p>This behaviour is set to change again soon so that the default layout will be applied to <code>.htm</code> and <code>.xhtml</code> files as well as <code>.html</code>. This will make the above two lines redundant. Middleman’s new behaviour makes the other page settings redundant as well as the line:</p> <pre class="code-quote ruby"><code><span class="n">page</span> <span class="s2">"/feed.xml"</span><span class="p">,</span> <span class="ss">layout: </span><span class="kp">false</span>
</code></pre> <h2 id="the-layout-file">The layout file</h2> <p>Open <code>my_test_website\source</code></p> <p>Delete the blank last line.</p> <p>Add a trailing slash to</p> <pre class="code-quote xml"><code>    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1"</span><span class="nt">&gt;</span>
</code></pre> <pre class="code-quote xml"><code>    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1"</span> <span class="nt">/&gt;</span>
</code></pre> <p>Delete</p> <pre class="code-quote xml"><code>    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span> <span class="nt">/&gt;</span>
</code></pre> <p>Replace:</p> <pre class="code-quote xml"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
</code></pre> <p>With:</p> <pre class="code-quote xml"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/1999/xhtml"</span> <span class="na">xml:lang=</span><span class="s">"en-gb-oxendict"</span><span class="nt">&gt;</span>
</code></pre> <p>Where <code>en-gb-oxendict</code> matches the <a href="http://www.w3.org/International/articles/language-tags/">language code</a> for the language of the website.</p> <h2 id="envoi">Envoi</h2> <p>If you followed the above steps, you should now have a Middleman build serving up <abbr title="eXtensible Hypertext Mark-up Language" class="initialism">X.H.T.M.L.</abbr></p> <footer> <p>This document was last modified on <time property="dcterms:modified schema:dateModified" datetime="2016-06-06T16:04:31+01:00">Monday 6<sup>th</sup>&#160;June,&#160;2016 at 16:04 (London)</time>.</p> <p id="nav_copyright" resource="#ccpattern" typeof="rdfa:Pattern">Copyright © <time property="schema:copyrightYear">1994</time>–<time>2016</time> <span property="cc:attributionName dcterms:creator schema:creator schema:publisher" resource="#me"><a href="https://isfeargoidte.me.uk" property="cc:attributionURL" rel="author">James Ó Nuanáin</a></span>. Except where otherwise indicated, this document (and all of its contents) is licensed under a <a accesskey="5" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" property="cc:license dcterms:license schema:license" rel="license">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International Licence</a>.</p> <address resource="#me" typeof="foaf:Person schema:Person"> <span property="foaf:name schema:Name">James Ó Nuanáin</span> has this website (<a property="foaf:weblog schema:url" href="https://isfeargoidte.me.uk/"><span xml:lang="ga-ie">Fear Goidte</span></a>). His inane witterings are also available on <span property="foaf:holdsAccount" typeof="foaf:OnlineAccount"> <a href="https://twitter.com/" property="foaf:accountServiceHomepage">Twitter</a> where his user name is ‘<span property="foaf:accountName"><a href="https://twitter.com/feargoidte">@feargoidte</a></span>’. </span> His feeble attempts at coding are available on <span property="foaf:holdsAccount" typeof="foaf:OnlineAccount"> <a property="foaf:accountServiceHomepage" href="https://github.com/">Github</a> where his user name is similarly ‘<span property="foaf:accountName"><a href="https://github.com/FearGoidte">FearGoidte</a></span>’. </span> </address> <table id="nav_accesskeys"> <caption>This page makes use of the following <code>accesskey</code> shortcuts:</caption> <thead> <tr> <th>Location</th> <th>Access Key</th> </tr> </thead> <tbody> <tr> <th>Home</th> <td><kbd>1</kbd></td> </tr> <tr> <th>Licence</th> <td><kbd>5</kbd></td> </tr> <tr> <th>Copyright</th> <td><kbd>6</kbd></td> </tr> <tr> <th>Validation</th> <td><kbd>v</kbd></td> </tr> <tr> <th>Access Keys</th> <td><kbd>k</kbd></td> </tr> <tr> <th>Previous article</th> <td><kbd>p</kbd></td> </tr> <tr> <th>Next article</th> <td><kbd>n</kbd></td> </tr> </tbody> </table> <p id="nav_validation">This page is authored in, <em>hopefully</em>, <a accesskey="v" href="https://validator.nu/?doc=https%3A%2F%2Fisfeargoidte.me.uk%2F2016%2F02%2F03%2Fa-little-something-extra-for-the-middleman&amp;showsource=yes&amp;showoutline=yes" rel="nofollow">well-formed <abbr title="eXtensible Hypertext Mark-up Langauge" class="initialism">X.H.T.M.L.</abbr></a> (the validator link is so that I can occasionally check on the mark-up).</p> </footer> </main> <div role="navigation"> <ol class="post-navigation"> <li class="icon prev">Previous: <a href="/2016/02/02/would-have-worn-gloves" rel="prev" accesskey="p" title="Previous article: If I’d known there’d be so much typing, I would have worn gloves">If I’d known there’d be so much typing, I would have worn gloves</a></li> <li><a href="../../../../archives">All articles</a></li> <li class="icon next">Next: <a href="/2016/02/19/weigh-anchor" rel="next" accesskey="n" title="Next article: Weigh anchor">Weigh anchor</a></li> </ol> </div> </body> </html>